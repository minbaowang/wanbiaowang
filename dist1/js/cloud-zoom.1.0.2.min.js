"use strict";!function($){function format(t){for(var o=1;o<arguments.length;o++)t=t.replace("%"+(o-1),arguments[o]);return t}function CloudZoom(d,u){var t,o,p,c,h,m,f,g,v=$("img",d),x=null,b=null,y=null,z=null,w=null,O=null,e=0,i=0,s=0,a=0,n=0,r=0,l=this;setTimeout(function(){if(null===b){var t=d.width();d.parent().append(format('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud-zoom-loading" >Loading...</div>',t/3,t/2-t/6)).find(":last").css("opacity",.5)}},200);this.removeBits=function(){y&&(y.remove(),y=null),z&&(z.remove(),z=null),w&&(w.remove(),w=null),null!==O&&(O.remove(),O=null),$(".cloud-zoom-loading",d.parent()).remove()},this.destroy=function(){d.data("zoom",null),b&&(b.unbind(),b.remove(),b=null),x&&(x.remove(),x=null),this.removeBits()},this.fadedOut=function(){x&&(x.remove(),x=null),this.removeBits()},this.controlLoop=function(){if(y){var t=m-v.offset().left-.5*c>>0,o=f-v.offset().top-.5*h>>0;t<0?t=0:t>v.outerWidth()-c&&(t=v.outerWidth()-c),o<0?o=0:o>v.outerHeight()-h&&(o=v.outerHeight()-h),y.css({left:t,top:o}),y.css("background-position",-t+"px "+-o+"px"),i=t/v.outerWidth()*p.width>>0,s=o/v.outerHeight()*p.height>>0,n+=(i-n)/u.smoothMove,a+=(s-a)/u.smoothMove,x.css("background-position",-(n>>0)+"px "+-(a>>0)+"px")}e=setTimeout(function(){l.controlLoop()},30)},this.init2=function(t,o){1===o&&(p=t),2===++r&&this.init()},this.init=function(){$(".cloud-zoom-loading",d.parent()).remove(),(b=d.parent().append(format("<div class='mousetrap' style='background-image:url(\".\");z-index:999;position:absolute;width:%0px;height:%1px;left:%2px;top:%3px;'></div>",v.outerWidth(),v.outerHeight(),0,0)).find(":last")).bind("mousemove",this,function(t){m=t.pageX,f=t.pageY}),b.bind("mouseleave",this,function(t){return clearTimeout(e),y&&y.fadeOut(299),z&&z.fadeOut(299),w&&w.fadeOut(299),x.fadeOut(300,function(){l.fadedOut()}),!1}),b.bind("mouseenter",this,function(t){m=t.pageX,f=t.pageY,g=t.data,x&&(x.stop(!0,!1),x.remove());var o=u.adjustX,e=u.adjustY,i=v.outerWidth(),s=v.outerHeight(),a=u.zoomWidth,n=u.zoomHeight;"auto"==u.zoomWidth&&(a=i),"auto"==u.zoomHeight&&(n=s);var r=d.parent();switch(u.position){case"top":e-=n;break;case"right":o+=i;break;case"bottom":e+=s;break;case"left":o-=a;break;case"inside":a=i,n=s;break;default:(r=$("#"+u.position)).length?(a=r.innerWidth(),n=r.innerHeight()):(r=d,o+=i,e+=s)}x=r.append(format('<div id="cloud-zoom-big" class="cloud-zoom-big" style="display:none;position:absolute;left:%0px;top:%1px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:99;"></div>',o,e,a,n,p.src)).find(":last"),v.attr("title")&&u.showTitle&&x.append(format('<div class="cloud-zoom-title">%0</div>',v.attr("title"))).find(":last").css("opacity",u.titleOpacity),$.browser.msie&&$.browser.version<7&&(O=$('<iframe frameborder="0" src="#"></iframe>').css({position:"absolute",left:o,top:e,zIndex:99,width:a,height:n}).insertBefore(x)),x.fadeIn(500),y&&(y.remove(),y=null),c=v.outerWidth()/p.width*x.width(),h=v.outerHeight()/p.height*x.height(),y=d.append(format("<div class = 'cloud-zoom-lens' style='display:none;z-index:98;position:absolute;width:%0px;height:%1px;'></div>",c,h)).find(":last"),b.css("cursor",y.css("cursor"));var l=!1;u.tint&&(y.css("background",'url("'+v.attr("src")+'")'),(z=d.append(format('<div style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',v.outerWidth(),v.outerHeight(),u.tint)).find(":last")).css("opacity",u.tintOpacity),l=!0,z.fadeIn(500)),u.softFocus&&(y.css("background",'url("'+v.attr("src")+'")'),(w=d.append(format('<div style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',v.outerWidth()-2,v.outerHeight()-2,u.tint)).find(":last")).css("background",'url("'+v.attr("src")+'")'),w.css("opacity",.5),l=!0,w.fadeIn(500)),l||y.css("opacity",u.lensOpacity),"inside"!==u.position&&y.fadeIn(500),g.controlLoop()})},t=new Image,$(t).load(function(){l.init2(this,0)}),t.src=v.attr("src"),o=new Image,$(o).load(function(){l.init2(this,1)}),o.src=d.attr("href")}$(document).ready(function(){$(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()}),$.fn.CloudZoom=function(options){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}return this.each(function(){var relOpts,opts;eval("var\ta = {"+$(this).attr("rel")+"}"),relOpts=a,$(this).is(".cloud-zoom")?($(this).css({position:"relative",display:"block"}),$("img",$(this)).css({display:"block"}),"wrap"!=$(this).parent().attr("id")&&$(this).wrap('<div id="wrap" style="top:0px;z-index:9999;position:relative;"></div>'),opts=$.extend({},$.fn.CloudZoom.defaults,options),opts=$.extend({},opts,relOpts),$(this).data("zoom",new CloudZoom($(this),opts))):$(this).is(".cloud-zoom-gallery")&&(opts=$.extend({},relOpts,options),$(this).data("relOpts",opts),$(this).bind("click",$(this),function(t){var o=t.data.data("relOpts");return $("#"+o.useZoom).data("zoom").destroy(),$("#"+o.useZoom).attr("href",t.data.attr("href")),$("#"+o.useZoom+" img").attr("src",t.data.data("relOpts").smallImage),$("#"+t.data.data("relOpts").useZoom).CloudZoom(),!1}))}),this},$.fn.CloudZoom.defaults={zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:.5,lensOpacity:.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:.5,adjustX:0,adjustY:0}}(jQuery);