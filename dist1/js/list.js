"use strict";document.addEventListener("DOMContentLoaded",function(){var e,l,t;!function(){var r=document.querySelector("#goodslist .goodslist .bottom .right .goods"),o=document.querySelector("#goodslist .goodslist .bottom .right .page"),e=document.querySelector("#goodslist .goodslist .bottom .right .sort"),s=document.querySelector("#goodslist .goodslist .top .zong"),c=[200,304],l=new XMLHttpRequest;l.onload=function(){if(0<=c.indexOf(l.status)){var e=JSON.parse(l.responseText),t=Math.ceil(e.total/e.qty);o.innerHTML="";for(var n=1;n<=t;n++){var a=document.createElement("span");(a.innerText=n)===e.pageNum?a.className="active":a.className="",o.appendChild(a)}s.innerText="共"+e.total+"件商品";var i=document.createElement("ul");i.innerHTML=e.data.map(function(e){return'<li data-guid="'+e.id+'">\n                                <img class="pic" src="'+e.imgurl+'" />\n                                <span class="small"><img src="'+e.imgurl+'" /></span> \n                                <p class="price">价格：<span>'+e.price+"</span></p>\n                                <h4>"+e.title+'</h4>\n                                <p class="num">销量：<span>'+e.num+'</span></p>\n                                <button class="addCar">加入购物车</button>\n                            </li>'}).join(""),r.innerHTML="",r.appendChild(i)}},l.open("get","../api/list.php?page=1&qty=15",!0),l.send();var t=!(o.onclick=function(e){if("span"===e.target.tagName.toLowerCase()){var t=e.target.innerText;l.open("get","../api/list.php?page="+t+"&qty=15",!0),l.send()}});e.onclick=function(e){t=!t,"price_sort"===e.target.className&&(l.open("get","../api/list.php?page=1&qty=15&param=price"+(t?"&desc":""),!0),l.send()),"num_sort"===e.target.className&&(l.open("get","../api/list.php?page=1&qty=15&param=num"+(t?"&desc":""),!0),l.send())}}(),e=document.querySelector(".goods"),l=document.cookie,t=l.indexOf("["),l=""===(l=l.slice(t))?[]:JSON.parse(l),e.onclick=function(e){if("addCar"===e.target.className){for(var t=e.target.parentNode,n=t.getAttribute("data-guid"),a=0;a<l.length;a++)if(n===l[a].guid){l[a].qty++;break}if(a===l.length){var i={guid:n,imgurl:t.children[0].src,price:t.children[2].innerText,name:t.children[3].innerText,qty:1};l.push(i)}document.cookie="goodslist="+JSON.stringify(l)}if("pic"===e.target.className){var r=e.target.parentNode,o={guid:r.getAttribute("data-guid"),imgurl:r.children[0].src,price:r.children[2].innerText,name:r.children[3].innerText},s="";for(var c in o)s+=c+"="+encodeURI(o[c])+"&";s=s.slice(0,-1),location.href="../html/detile.html?"+s}},document.querySelector(".header_search .car").onclick=function(){location.href="../html/car.html"}});